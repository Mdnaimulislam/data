name: Move Issue or PR to Project Column

on:
  issues:
    types: [opened]
  pull_request:
    types: [opened]

jobs:
  move_item_to_project_column:
    runs-on: ubuntu-latest
    steps:
    - name: Move issue to issue column
      if: github.event_name == 'issues'
      uses: actions/github-script@v5
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        script: |
          const projectId = 1;
          const columnName = 'Issues';
          const issueId = context.issue.node_id;
          const { repo: { owner, repo } } = context;

          const columns = await github.rest.projects.listColumns({ project_id: projectId });
          const column = columns.data.find(column => column.name === columnName);

          await github.rest.projects.createCard({
            column_id: column.id,
            content_id: issueId,
            content_type: 'Issue'
          });

    - name: Move pull request to PR column
      if: github.event_name == 'pull_request'
      uses: actions/github-script@v5
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        script: |
          const projectId = 1;
          const columnName = 'Pull Requests';
          const pullRequestId = context.payload.pull_request.node_id;
          const { repo: { owner, repo } } = context;

          const columns = await github.rest.projects.listColumns({ project_id: projectId });
          const column = columns.data.find(column => column.name === columnName);

          await github.rest.projects.createCard({
            column_id: column.id,
            content_id: pullRequestId,
            content_type: 'PullRequest'
          });
